{"version":3,"sources":["article-service.ts"],"names":["Article","Article.constructor","ArticleService","ArticleService.constructor","ArticleService.getArticles","ArticleService.initialGet","ArticleService.getWidth","ArticleService.sortNews","ArticleService.sortByDate","ArticleService.sortByUpvotes","ArticleService.sortByPoster"],"mappings":"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","file":"article-service.js","sourcesContent":["import { Http, HTTP_PROVIDERS } from 'angular2/http';\r\nimport { Observable } from 'angular2/angular2';\r\nimport { Injectable } from 'angular2/core';\r\n\r\nexport class Article {\r\n\tdescription: string;\r\n\tupvotes: number;\r\n\tstoryImageUrl: string;\r\n\twidth: number;\r\n\tauthor: { userName: string, userImage: string };\r\n\t\r\n\tconstructor( public headline: string, public timePosted: number, public link: string ) { }\r\n}\r\n\r\n@Injectable()\r\nexport class ArticleService {\r\n\tapiEndpoint = 'http://www.freecodecamp.com/news/hot';\r\n\tarticles: Article[] = [];\r\n\t\r\n\tMAX_IMAGE_WID = 240;\r\n\t\r\n\tconstructor( public http: Http ) {\r\n\t\tthis.initialGet();\r\n\t}\r\n\t\r\n\tgetArticles(): Observable<any> {\r\n\t\treturn this.http.get(this.apiEndpoint).map(res => res.json());\r\n\t}\r\n\t\r\n\tinitialGet() {\r\n\t\tthis.getArticles()\r\n\t\t\t.subscribe(\r\n\t\t\t\tresultArr => {\r\n\t\t\t\t\tresultArr.map(\r\n\t\t\t\t\t\tresArticle => {\r\n\t\t\t\t\t\t\tlet article = new Article(resArticle.headline, resArticle.timePosted, resArticle.link);\r\n\t\t\t\t\t\t\tarticle.description = resArticle.metaDescription;\r\n\t\t\t\t\t\t\tarticle.upvotes = resArticle.rank;\r\n\t\t\t\t\t\t\tarticle.author = { userName : resArticle.author.username, userImage : resArticle.author.picture };\r\n\t\t\t\t\t\t\tif (resArticle.image) article.storyImageUrl = resArticle.image;\r\n\t\t\t\t\t\t\telse article.storyImageUrl = article.author.userImage;\r\n\t\t\t\t\t\t\tthis.getWidth(article.storyImageUrl)\r\n\t\t\t\t\t\t\t\t.subscribe( width => {\r\n\t\t\t\t\t\t\t\t\tif (width > this.MAX_IMAGE_WID) article.width = this.MAX_IMAGE_WID;\r\n\t\t\t\t\t\t\t\t\telse article.width = width;\r\n\t\t\t\t\t\t\t\t\tthis.articles.push(article);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t}\r\n\t\r\n\tgetWidth(url: string): Observable<number> {\r\n\t\treturn new Observable(observer => {\r\n\t\t\tlet img = new Image();\r\n\t\t\timg.src = url;\r\n\t\t\timg.onload = () => {\r\n\t\t\t\tobserver.next(img.width);\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n\t\r\n\tsortNews(sortby: string) {\r\n\t\tswitch (sortby) {\r\n\t\t\tcase 'date':\r\n\t\t\t\tthis.articles.sort(this.sortByDate);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'upvotes':\r\n\t\t\t\tthis.articles.sort(this.sortByUpvotes);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'poster':\r\n\t\t\t\tthis.articles.sort(this.sortByPoster);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\t\r\n\tsortByDate(a: Article, b: Article) {\r\n\t\treturn b.timePosted - a.timePosted;\r\n\t}\r\n\t\r\n\tsortByUpvotes(a: Article, b: Article) {\r\n\t\treturn b.upvotes - a.upvotes;\r\n\t}\r\n\t\r\n\tsortByPoster(a: Article, b: Article) {\r\n\t\tlet aPoster = a.author.userName;\r\n\t\tlet bPoster = b.author.userName;\r\n\t\tif (aPoster < bPoster) return -1;\r\n\t\tif (aPoster > bPoster) return 1;\r\n\t\treturn 0;\r\n\t}\r\n\t\r\n}"],"sourceRoot":"/source/"}